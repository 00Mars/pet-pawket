/* /public/css/shop.css
   Shop page — match PDP glass & layered depth using your existing classes.
*/

/* ===========================================================
   TOKENS (reuses site vars if present)
=========================================================== */
:root{
  --nav-fixed-h: var(--nav-offset, 6.2rem);

  /* plates + card glass (aligned to PDP) */
  --shop-plate-1: rgba(255,255,255,.32);
  --shop-plate-2: rgba(255,255,255,.44);
  --shop-plate-3: rgba(255,255,255,.58);
  --shop-card:   rgba(255,255,255,.96);
  --shop-border: rgba(0,0,0,.09);

  --shop-radius-lg: 20px;
  --shop-radius-md: 14px;

  --shop-shadow-sm: 0 4px 14px rgba(0,0,0,.08);
  --shop-shadow-md: 0 10px 26px rgba(0,0,0,.10);
  --shop-shadow-lg: 0 18px 42px rgba(0,0,0,.12);

  --shop-surface-overscan: 16px;

  /* text/links */
  --pp-text: #1d2a32;
  --pp-text-subtle: #3c596b;
  --pp-link: #0b74ff;

  /* accents (sun + sky) */
  --shop-sun: var(--accent-orange, #ff9a1a);
  --shop-sky: var(--brand-blue,   #0b74ff);

  /* soft tints (safe fallback; upgraded with color-mix below) */
  --shop-sun-soft: rgba(255,154,26,.22);
  --shop-sky-soft: rgba(11,116,255,.18);
}
@supports (color-mix(in srgb, red, white)) {
  :root{
    --shop-sun-soft: color-mix(in srgb, var(--shop-sun) 24%, transparent);
    --shop-sky-soft: color-mix(in srgb, var(--shop-sky) 22%, transparent);
  }
}

/* ===========================================================
   PAGE SURFACE (uses your .shop-surface)
=========================================================== */
.shop-page{ position:relative; isolation:isolate; color:var(--pp-text); }

.shop-surface{ position:relative; z-index:0; }

/* Warm/cool veil, side softeners, and slight blur—behind ALL content */
.shop-surface::before{
  content:"";
  position:fixed; inset:0; z-index:-1; pointer-events:none;
  background:
    /* side softeners like PDP */
    linear-gradient(90deg, rgba(255,255,255,.22), rgba(255,255,255,0) 20%, rgba(255,255,255,0) 80%, rgba(255,255,255,.22)),
    /* warm bloom near top */
    radial-gradient(1100px 650px at 50% 18%, var(--shop-sun-soft), transparent 70%),
    /* sky bloom lower */
    radial-gradient(1200px 700px at 50% 74%, var(--shop-sky-soft), transparent 70%);
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
}

/* Fill up under the fixed navbar so the glass looks continuous */
.shop-surface::after{
  content:"";
  position:fixed; left:0; right:0; top:0;
  height: calc(var(--nav-fixed-h) + var(--shop-surface-overscan));
  z-index:-1; pointer-events:none;
  background: linear-gradient(180deg, var(--shop-sun-soft), transparent 75%);
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);
}

/* ===========================================================
   HEADER (sun = top rail, sky = bottom rail) — your .head-card
=========================================================== */
.shop-head{
  position:relative; z-index:1;
  margin-top:0;
  padding-top: calc(var(--nav-fixed-h) + 10px); /* clear fixed nav */
  margin-bottom: 12px;
}

.head-card{
  position:relative; overflow:hidden;
  margin:3rem;
  padding:1.25rem 1.35rem;
  border:1px solid var(--shop-border);
  border-radius: var(--shop-radius-lg);
  background: var(--shop-card);
  box-shadow: var(--shop-shadow-md);
  /* ensure no blur is applied to content by global “glass” rules */
  filter: none !important;
  backdrop-filter: blur(6px) saturate(240%);
  -webkit-backdrop-filter: blur(6px) saturate(240%);
}

/* SUN (orange) on TOP */
.head-card::before{
  content:""; position:absolute; left:0; right:0; top:0; height:14px; pointer-events:none;
  background: linear-gradient(
    180deg,
    color-mix(in srgb, var(--shop-sun) 38%, transparent) 0%,
    color-mix(in srgb, var(--shop-sun) 18%, transparent) 35%,
    color-mix(in srgb, var(--shop-sun) 10%, transparent) 65%,
    transparent 90%
  );
}
/* SKY (blue) on BOTTOM */
.head-card::after{
  content:""; position:absolute; left:0; right:0; bottom:0; height:12px; pointer-events:none;
  background: linear-gradient(
    0deg,
    color-mix(in srgb, var(--shop-sky) 36%, transparent) 0%,
    color-mix(in srgb, var(--shop-sky) 18%, transparent) 45%,
    color-mix(in srgb, var(--shop-sky) 10%, transparent) 70%,
    transparent 90%
  );
}

.shop-title{
  margin:0 0 .35rem;
  font-size: clamp(1.7rem, 1.1rem + 2.4vw, 2.4rem);
  font-weight:800; line-height:1.2; color:#0e2430;
}
.shop-subtitle{ margin:.45rem 0 0; color:#284454; text-shadow:0 1px 0 rgba(255,255,255,.35); }

/* ===========================================================
   PRODUCT PANEL — layered plates using your .shop-grid > .container
=========================================================== */
.shop-grid{ position:relative; z-index:1; margin:0; padding-bottom:50px; }

.shop-grid > .container{
  position:relative;
  margin:0 auto;
  padding:1rem;
  border:1px solid var(--shop-border);
  border-radius: var(--shop-radius-lg);
  background: rgba(255,255,255,.10);
  box-shadow: var(--shop-shadow-sm);
  filter: none !important;
  backdrop-filter: blur(6px) saturate(120%) !important;
  -webkit-backdrop-filter: blur(6px) saturate(120%) !important;
  container-type: inline-size;
}

/* Plate depth (2 pseudo-plates + the container as top plate) */
.shop-grid > .container::before,
.shop-grid > .container::after{
  content:"";
  position:absolute; inset:0;
  border-radius: calc(var(--shop-radius-lg) + 6px);
  border:1px solid var(--shop-border);
  pointer-events:none;
}
.shop-grid > .container::before{
  background: var(--shop-plate-1);
  box-shadow: var(--shop-shadow-sm);
  transform: translateY(-6px);
  backdrop-filter: blur(1.5px);
}
.shop-grid > .container::after{
  background: var(--shop-plate-2);
  box-shadow: var(--shop-shadow-md);
  transform: translateY(6px);
  backdrop-filter: blur(2.5px);
}

/* ===========================================================
   CHIPS & CONTROLS (sticky tray under navbar)
=========================================================== */
.pp-chips{ display:flex; flex-wrap:wrap; gap:.5rem; margin:.25rem 0; }
.chip{
  padding:.5rem .8rem; border:1px solid rgba(0,0,0,.12);
  border-radius:999px; font-size:.92rem; background: rgba(255,255,255,.96);
}
.chip[aria-pressed="true"]{
  border-color: color-mix(in srgb, var(--shop-sun) 55%, transparent);
  color:#3a2200;
  background: color-mix(in srgb, var(--shop-sun) 18%, transparent);
  box-shadow: inset 0 0 0 2px color-mix(in srgb, var(--shop-sun) 16%, transparent);
}

.pp-controls{
  position:sticky; top: var(--nav-fixed-h); z-index:3;
  display:grid; grid-template-columns: 1fr 180px 180px; gap:.75rem;
  margin:.5rem 0 .75rem; padding:.75rem;
  border:1px solid var(--shop-border);
  border-radius: var(--shop-radius-lg);
  background: var(--shop-card);
  box-shadow: var(--shop-shadow-sm);
  filter: none !important;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}
.pp-controls .control{ display:grid; grid-template-rows:auto 1fr; }
.pp-controls label{ margin:0 0 .25rem; font-size:.875rem; color:var(--pp-text-subtle); }
.pp-controls input[type="search"],
.pp-controls select{
  width:100%; padding:.6rem .75rem; border:1px solid rgba(0,0,0,.12);
  border-radius:14px; font-size:1rem; background: rgba(255,255,255,.95);
}
.pp-controls input[type="search"]:focus,
.pp-controls select:focus{
  border-color: var(--shop-sky);
  outline: 3px solid color-mix(in srgb, var(--shop-sky) 30%, transparent);
  outline-offset: 2px;
}

.pp-status{ min-height:1.25rem; margin:.25rem 0 .5rem; font-size:.95rem; color:var(--pp-text-subtle); }

/* ===========================================================
   GRID
=========================================================== */
.pp-grid, #pp-grid{
  z-index:2;
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(220px,1fr));
  gap:.9rem; margin:.5rem 0 2rem; padding:0 0 2rem; list-style:none;
}

/* ===========================================================
   CARD
=========================================================== */
.pp-card{
  position:relative; display:grid; grid-template-rows:auto 1fr;
  background:#fff; border:1px solid var(--shop-border);
  border-radius: var(--shop-radius-lg);
  box-shadow: var(--shop-shadow-sm);
  overflow:hidden;
}
.pp-card .stretched-link::after{ border-radius:inherit; background:transparent!important; }
.pp-card .view-link{ padding:0!important; border:0!important; background:transparent!important; color:inherit!important; }

.pp-card .media{
  width:100%; aspect-ratio:1/1; background:#f3f6f8;
  display:grid; place-items:center;
}
@container (min-width:900px){  .pp-card .media{ aspect-ratio:3/4; } }
@container (min-width:1200px){ .pp-card .media{ aspect-ratio:2/3; } }
.pp-card .media img{ width:100%; height:100%; object-fit:cover; object-position:center; display:block; }

.pp-card .body{ padding:.6rem .7rem .7rem; }
.pp-card .title{
  font-size:.95rem; line-height:1.25; margin:0 0 .35rem; color:var(--pp-text);
  display:-webkit-box; -webkit-box-orient:vertical; -webkit-line-clamp:2; line-clamp:2; overflow:hidden;
}
.pp-card .price{ font-size:.9rem; color:var(--pp-text-subtle); margin:0 0 .5rem; }
.pp-card .cta-row{ display:flex; gap:.5rem; }

/* wishlist pill */
.pp-card .wish{
  display:inline-flex; justify-content:center; align-items:center;
  width:42px; height:42px; border:1px solid rgba(220,0,100,.25);
  border-radius:50%; background: rgba(255,255,255,.96);
}
.pp-card .wish .bi{ font-size:1rem; }
.pp-card .wish[aria-pressed="true"] .bi{ color:#ff4b98; }

/* ===========================================================
   SKELETONS
=========================================================== */
.pp-skel{
  display:flex; flex-direction:column; overflow:hidden;
  border:1px solid var(--shop-border);
  border-radius: var(--shop-radius-lg);
  background: var(--shop-plate-2);
  box-shadow: var(--shop-shadow-sm);
}
.pp-skel .block, .pp-skel .bar{
  background: linear-gradient(90deg,#f0f4f8 0%,#e7eef5 50%,#f0f4f8 100%);
  background-size:200% 100%;
  animation: pp-shimmer 1.1s linear infinite;
}
.pp-skel .block{ width:100%; aspect-ratio:1/1; }
.pp-skel .stack{ display:grid; grid-template-rows:auto auto auto; gap:.5rem; padding:.8rem .9rem .9rem; }
.pp-skel .bar{ width:100%; height:12px; }
.pp-skel .bar.w60{ width:60%; } .pp-skel .bar.w40{ width:40%; }
@keyframes pp-shimmer{ 0%{ background-position-x:0 } 100%{ background-position-x:200% } }

/* ===========================================================
   LINKS & FOCUS
=========================================================== */
a{ color: var(--pp-link); }
a:focus{ outline:3px solid color-mix(in srgb, var(--shop-sky) 30%, transparent); outline-offset:2px; }

/* ===========================================================
   RESPONSIVE
=========================================================== */
@media (width <= 860px){
  .pp-controls{ grid-template-columns: 1fr 1fr; }
  .pp-controls .control:nth-child(3){ grid-column: 1 / -1; }
}
@media (width <= 560px){
  .pp-controls{ grid-template-columns: 1fr; }
}

/* ===========================================================
   NO-BLUR FALLBACKS
=========================================================== */
@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))){
  .head-card,
  .pp-controls,
  .shop-grid > .container{ background: rgba(255,255,255,.92) !important; }
  .shop-grid > .container::before{ background: rgba(255,255,255,.85); }
  .shop-grid > .container::after { background: rgba(255,255,255,.92); }
}
