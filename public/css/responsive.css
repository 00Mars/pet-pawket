/* /public/css/responsive-upgrade.css
   Pet Pawket â€” Responsiveness Upgrade (2025-10-04)
   - Fluid type & spacing via clamp()
   - Container queries for cards, grids, navbar, and product detail
   - Grid auto-fit patterns and robust image sizing to reduce CLS
   - No HTML changes required (establishes containers via CSS)
*/

/* ------------------ Fluid type & rhythm ------------------ */
:root{
  /* Type scale (system-ui fallback kept by existing CSS) */
  --step--1: clamp(0.88rem, 0.84rem + 0.2vw, 0.98rem);
  --step-0:  clamp(1.00rem, 0.95rem + 0.30vw, 1.13rem);
  --step-1:  clamp(1.25rem, 1.12rem + 0.60vw, 1.50rem);
  --step-2:  clamp(1.56rem, 1.30rem + 1.10vw, 2.00rem);
  --step-3:  clamp(1.95rem, 1.50rem + 1.60vw, 2.60rem);

  --rhythm-0: clamp(8px, 0.6vw, 12px);
  --rhythm-1: clamp(12px, 1vw, 16px);
  --rhythm-2: clamp(16px, 1.6vw, 24px);
  --rhythm-3: clamp(20px, 2.2vw, 32px);

  /* Safe container paddings */
  --container-pad-x: clamp(12px, 3cqi, 24px);
}

/* Apply scale without fighting existing tokens */
body{ font-size: var(--step-0); line-height: 1.5; }
h1{ font-size: var(--step-3); line-height: 1.15; }
h2{ font-size: var(--step-2); line-height: 1.20; }
h3{ font-size: var(--step-1); line-height: 1.25; }

/* ------------------ Container establishment ------------------ */
/* We turn key wrappers into queryable containers without HTML edits */
.shop-grid .container,
.product-surface .container,
.custom-navbar .navbar-container,
.pp-card,
#pp-product,
#pp-my-pane{
  container-type: inline-size;
}

/* ------------------ Shop grid (auto-fit + CQ) ------------------ */
/* Grid wrapper */
.pp-grid{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(clamp(220px, 30cqi, 320px), 1fr));
  gap: var(--rhythm-2);
  padding-inline: var(--container-pad-x);
}

/* Product card */
.pp-card{
  display: grid;
  grid-template-rows: auto 1fr;
  align-content: start;
  gap: var(--rhythm-1);
  background: var(--pp-card-bg, rgba(255,255,255,.75));
  border: 1px solid var(--pp-card-border, rgba(0,0,0,.06));
  border-radius: 16px;
  box-shadow: var(--pp-card-shadow, 0 2px 8px rgba(0,0,0,.04));
  overflow: clip;
}

/* Card media block stabilizes layout */
.pp-card .p-img{
  position: relative;
  aspect-ratio: 4 / 3;           /* CLS guard for list tiles */
  overflow: hidden;
}
.pp-card .p-img img{
  display: block;
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  inline-size: 100%;
  block-size: auto;
}

/* Card body */
.pp-card .p-body{ padding: var(--rhythm-2); }
.pp-card .p-title{ font-size: var(--step-0); font-weight: 600; margin: 0 0 var(--rhythm-0); }
.pp-card .p-price{ font-size: var(--step-0); font-weight: 500; }

/* On wider card containers, switch to side-by-side card */
@container (min-width: 560px){
  .pp-card{
    grid-template-columns: 42% 1fr;
    grid-template-rows: auto;
  }
  .pp-card .p-img{ aspect-ratio: 1 / 1; }
}

/* Skeleton cards keep same proportions */
.pp-skel .block{ aspect-ratio: 4 / 3; }
@container (min-width: 560px){
  .pp-skel{ display: grid; grid-template-columns: 42% 1fr; gap: var(--rhythm-1); }
  .pp-skel .block{ aspect-ratio: 1 / 1; }
}

/* ------------------ Controls reflow ------------------ */
.pp-controls{
  display: grid;
  gap: var(--rhythm-1);
}
@container (min-width: 820px){
  .pp-controls{
    grid-template-columns: 1fr 160px 160px 140px;
    align-items: end;
  }
}

/* ------------------ "For My Pets" pane ------------------ */
#pp-my-pane{
  display: grid;
  gap: var(--rhythm-2);
  padding: var(--rhythm-2);
  background: var(--pp-pane-bg, rgba(255,255,255,.65));
  border: 1px solid var(--pp-card-border, rgba(0,0,0,.06));
  border-radius: 16px;
}
@container (min-width: 720px){
  #pp-my-pane{ grid-template-columns: 1fr 1fr; }
}

/* ------------------ Product detail ------------------ */
#pp-product{
  display: grid;
  gap: var(--rhythm-2);
}
@container (min-width: 860px){
  #pp-product{
    grid-template-columns: minmax(280px, 560px) 1fr;
    align-items: start;
  }
}
/* Gallery stabilization */
#pp-product .pp-gallery{
  display: grid;
  gap: var(--rhythm-1);
}
#pp-product .pp-gallery .main{
  position: relative;
  aspect-ratio: 4 / 3;           /* CLS guard on PDP */
  overflow: hidden;
  background: rgba(0,0,0,.03);
}
#pp-product .pp-gallery .main img{
  width: 100%; height: 100%; object-fit: cover;
}
#pp-product .p-thumbs{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(56px, 1fr));
  gap: var(--rhythm-0);
}

/* Buy box */
#pp-product .p-buy{ display: grid; gap: var(--rhythm-1); }

/* ------------------ Navbar CQ refinements ------------------ */
.custom-navbar .navbar-container{
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  gap: var(--rhythm-1);
  padding-inline: var(--container-pad-x);
}

/* When the nav container gets tight, allow wrapping and shrink gaps */
@container (max-width: 760px){
  .custom-navbar .navbar-container{
    grid-template-columns: 1fr auto;
    grid-auto-rows: min-content;
    row-gap: var(--rhythm-0);
  }
  .custom-navbar .nav-right{ justify-self: end; gap: 0.5rem; }
}

/* ------------------ Media hygiene ------------------ */
img{ max-width: 100%; height: auto; }
picture{ display: contents; } /* keep semantic source switching without extra boxes */

/* ------------------ Motion/accessibility ------------------ */
@media (prefers-reduced-motion: reduce){
  *{ animation: none !important; transition: none !important; scroll-behavior: auto !important; }
}

/* ------------------ Hero height guard (mobile 100vh issues) ------------------ */
.hero-slide-1, .hero-slide-2{ min-height: min(75vh, 680px); }
